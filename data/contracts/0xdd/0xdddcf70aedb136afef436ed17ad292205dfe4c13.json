{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.19;\r\n\r\nlibrary SafeMath {\r\n\r\n  /**\r\n  * @dev Multiplies two numbers, throws on overflow.\r\n  */\r\n  function mul(uint256 a, uint256 b) internal pure returns (uint256) {\r\n    if (a == 0) {\r\n      return 0;\r\n    }\r\n    uint256 c = a * b;\r\n    assert(c / a == b);\r\n    return c;\r\n  }\r\n\r\n  /**\r\n  * @dev Integer division of two numbers, truncating the quotient.\r\n  */\r\n  function div(uint256 a, uint256 b) internal pure returns (uint256) {\r\n    // assert(b > 0); // Solidity automatically throws when dividing by 0\r\n    uint256 c = a / b;\r\n    // assert(a == b * c + a % b); // There is no case in which this doesn't hold\r\n    return c;\r\n  }\r\n\r\n  /**\r\n  * @dev Substracts two numbers, throws on overflow (i.e. if subtrahend is greater than minuend).\r\n  */\r\n  function sub(uint256 a, uint256 b) internal pure returns (uint256) {\r\n    assert(b <= a);\r\n    return a - b;\r\n  }\r\n\r\n  /**\r\n  * @dev Adds two numbers, throws on overflow.\r\n  */\r\n  function add(uint256 a, uint256 b) internal pure returns (uint256) {\r\n    uint256 c = a + b;\r\n    assert(c >= a);\r\n    return c;\r\n  }\r\n}\r\n\r\n\r\n\r\ncontract CryptoHearthStone {\r\n  using SafeMath for uint256;\r\n  struct Card {\r\n        uint attribute; // Card occupational attributes\r\n        uint256 price;// Card price\r\n        address delegate; // person delegated to\r\n        bool isSale;//Is the card sold?\r\n  }\r\n\r\n  Card[] private cards;\r\n\r\n  mapping (address => uint) private ownershipCardCount;\r\n\r\n  event Transfer(address from, address to, uint256 cardId);\r\n\r\n  event CardSold(uint256 cardId, uint256 price, address prevOwner, address newOwner);\r\n\r\n  event userSell(uint256 cardId, uint256 price, address owner);\r\n\r\n  event CancelCardSell(uint256 cardId, address owner);\r\n\r\n  uint constant private DEFAULT_START_PRICE = 0.01 ether;\r\n  uint constant private FIRST_PRICE_LIMIT =  0.5 ether;\r\n  uint constant private SECOND_PRICE_LIMIT =  2 ether;\r\n  uint constant private THIRD_PRICE_LIMIT =  5 ether;\r\n\r\n  uint constant private FIRST_COMMISSION_LEVEL = 6;\r\n  uint constant private SECOND_COMMISSION_LEVEL = 5;\r\n  uint constant private THIRD_COMMISSION_LEVEL = 4;\r\n  uint constant private FOURTH_COMMISSION_LEVEL = 3;\r\n\r\n  address private owner;\r\n  mapping (address => bool) private admins;\r\n\r\n  function CryptoHearthStone () public {\r\n    owner = msg.sender;\r\n    admins[owner] = true;\r\n  }\r\n   /* Modifiers */\r\n   modifier onlyOwner() {\r\n     require(owner == msg.sender);\r\n     _;\r\n   }\r\n\r\n   modifier onlyAdmins() {\r\n     require(admins[msg.sender]);\r\n     _;\r\n   }\r\n\r\n   function addAdmin (address _admin) onlyOwner() public {\r\n     admins[_admin] = true;\r\n   }\r\n\r\n   function removeAdmin (address _admin) onlyOwner() public {\r\n     delete admins[_admin];\r\n   }\r\n\r\n   function withdrawAll () onlyAdmins() public {\r\n     msg.sender.transfer(this.balance);\r\n   }\r\n\r\n  function withdrawAmount (uint256 _amount) onlyAdmins() public {\r\n    msg.sender.transfer(_amount);\r\n  }\r\n\r\n  function initCards (uint _attribut) onlyAdmins() public {\r\n      for(uint i=0;i<10;i++)\r\n      {\r\n          createCard(_attribut,20800000000000000);\r\n      }\r\n  }\r\n\r\n  function createCard (uint _attribute, uint256 _price) onlyAdmins() public {\r\n    require(_price > 0);\r\n\r\n    Card memory _card = Card({\r\n      attribute: _attribute,\r\n      price: _price,\r\n      delegate: msg.sender,\r\n      isSale: true\r\n    });\r\n    cards.push(_card);\r\n  }\r\n\r\n  function getCard(uint _id) public view returns (uint attribute, uint256 price,address delegate,bool isSale,bool isWoner) {\r\n    require(_id < cards.length);\r\n    require(_addressNotNull(msg.sender));\r\n    Card memory _card=cards[_id];\r\n    isWoner=false;\r\n    if(_card.delegate==msg.sender) isWoner=true;\r\n    return (_card.attribute,_card.price,_card.delegate,_card.isSale,isWoner);\r\n  }\r\n\r\n  function getMyCards(address _owner) public view returns (uint[] userCards) {\r\n    require(_addressNotNull(_owner));\r\n    uint cardCount = ownershipCardCount[_owner];\r\n    userCards = new uint[](cardCount);\r\n    if(_owner==owner)return userCards;\r\n    uint totalTeams = cards.length;\r\n    uint resultIndex = 0;\r\n    if (cardCount > 0) {\r\n      for (uint pos = 0; pos < totalTeams; pos++) {\r\n        if (cardOwnerOf(pos) == _owner) {\r\n          userCards[resultIndex] = pos;\r\n          resultIndex++;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function purchase(uint _cardId) public payable {\r\n    address oldOwner = cardOwnerOf(_cardId);\r\n    address newOwner = msg.sender;\r\n\r\n    uint sellingPrice = cards[_cardId].price;\r\n    require(newOwner != owner);\r\n\r\n    require(oldOwner != newOwner);\r\n\r\n    require(_addressNotNull(newOwner));\r\n\r\n    require(cards[_cardId].isSale == true);\r\n\r\n    require(msg.value >= sellingPrice);\r\n\r\n    uint payment =  _calculatePaymentToOwner(sellingPrice);\r\n    uint excessPayment = msg.value.sub(sellingPrice);\r\n\r\n    _transfer(oldOwner, newOwner, _cardId);\r\n    if (oldOwner != address(this)) {\r\n      oldOwner.transfer(payment);\r\n    }\r\n\r\n    newOwner.transfer(excessPayment);\r\n\r\n    CardSold(_cardId, sellingPrice, oldOwner, newOwner);\r\n  }\r\n\r\n  function sell(uint _cardId, uint256 _price) public {\r\n      require(_price > 0);\r\n      address oldOwner = cardOwnerOf(_cardId);\r\n      require(_addressNotNull(oldOwner));\r\n      require(oldOwner == msg.sender);\r\n      cards[_cardId].price=_price;\r\n      cards[_cardId].isSale=true;\r\n      userSell(_cardId, _price,oldOwner);\r\n  }\r\n\r\n  function CancelSell(uint _cardId) public {\r\n      address oldOwner = cardOwnerOf(_cardId);\r\n      require(_addressNotNull(oldOwner));\r\n      require(oldOwner == msg.sender);\r\n      cards[_cardId].isSale=false;\r\n      CancelCardSell(_cardId,oldOwner);\r\n  }\r\n\r\n  function _calculatePaymentToOwner(uint _sellingPrice) private pure returns (uint payment) {\r\n    if (_sellingPrice < FIRST_PRICE_LIMIT) {\r\n      payment = uint256(_sellingPrice.mul(100-FIRST_COMMISSION_LEVEL).div(100));\r\n    }\r\n    else if (_sellingPrice < SECOND_PRICE_LIMIT) {\r\n      payment = uint256(_sellingPrice.mul(100-SECOND_COMMISSION_LEVEL).div(100));\r\n    }\r\n    else if (_sellingPrice < THIRD_PRICE_LIMIT) {\r\n      payment = uint256(_sellingPrice.mul(100-THIRD_COMMISSION_LEVEL).div(100));\r\n    }\r\n    else {\r\n      payment = uint256(_sellingPrice.mul(100-FOURTH_COMMISSION_LEVEL).div(100));\r\n    }\r\n  }\r\n\r\n  function cardOwnerOf(uint _cardId) public view returns (address cardOwner) {\r\n    require(_cardId < cards.length);\r\n    cardOwner = cards[_cardId].delegate;\r\n  }\r\n\r\n  function _addressNotNull(address _to) private pure returns (bool) {\r\n    return _to != address(0);\r\n  }\r\n\r\n  function _transfer(address _from, address _to, uint _cardId) private {\r\n    ownershipCardCount[_to]++;\r\n    cards[_cardId].delegate=_to;\r\n    cards[_cardId].isSale=false;\r\n    if (_from != address(0)) {\r\n      ownershipCardCount[_from]--;\r\n    }\r\n\r\n    Transfer(_from, _to, _cardId);\r\n  }\r\n}","ABI":"[{\"constant\":false,\"inputs\":[{\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"withdrawAmount\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_cardId\",\"type\":\"uint256\"}],\"name\":\"cardOwnerOf\",\"outputs\":[{\"name\":\"cardOwner\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_attribute\",\"type\":\"uint256\"},{\"name\":\"_price\",\"type\":\"uint256\"}],\"name\":\"createCard\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_admin\",\"type\":\"address\"}],\"name\":\"removeAdmin\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"getMyCards\",\"outputs\":[{\"name\":\"userCards\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_admin\",\"type\":\"address\"}],\"name\":\"addAdmin\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_attribut\",\"type\":\"uint256\"}],\"name\":\"initCards\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"withdrawAll\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_cardId\",\"type\":\"uint256\"}],\"name\":\"CancelSell\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_id\",\"type\":\"uint256\"}],\"name\":\"getCard\",\"outputs\":[{\"name\":\"attribute\",\"type\":\"uint256\"},{\"name\":\"price\",\"type\":\"uint256\"},{\"name\":\"delegate\",\"type\":\"address\"},{\"name\":\"isSale\",\"type\":\"bool\"},{\"name\":\"isWoner\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_cardId\",\"type\":\"uint256\"},{\"name\":\"_price\",\"type\":\"uint256\"}],\"name\":\"sell\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_cardId\",\"type\":\"uint256\"}],\"name\":\"purchase\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"from\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"cardId\",\"type\":\"uint256\"}],\"name\":\"Transfer\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"cardId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"price\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"prevOwner\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"CardSold\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"cardId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"price\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"owner\",\"type\":\"address\"}],\"name\":\"userSell\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"cardId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"owner\",\"type\":\"address\"}],\"name\":\"CancelCardSell\",\"type\":\"event\"}]","ContractName":"CryptoHearthStone","CompilerVersion":"v0.4.22+commit.4cb486ee","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"","Library":"","LicenseType":"MIT","SwarmSource":"bzzr://b2aa83b1c4d8b80e923bb5f086cf9ffaab5220753951f153bf05c72cadbdff80"}]}